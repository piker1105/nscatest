<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Recharts -->
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8; 
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- 1. Fix for Recharts/React defaultProps Warning ---
        // 這個區塊用來隱藏控制台惱人的 defaultProps 警告
        const originalConsoleError = console.error;
        console.error = (...args) => {
            if (typeof args[0] === 'string' && /defaultProps/.test(args[0])) {
                return;
            }
            originalConsoleError(...args);
        };

        const { useState, useEffect, useMemo } = React;
        const { 
            LineChart, Line, BarChart, Bar, AreaChart, Area, XAxis, YAxis, 
            CartesianGrid, Tooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell 
        } = Recharts;
        const { 
            LayoutDashboard, Users, ShoppingCart, DollarSign, TrendingUp, 
            ArrowUpRight, ArrowDownRight, Bell, Search, Menu, X, MoreHorizontal,
            Package, Activity, CreditCard, Calendar
        } = lucideReact;

        // --- Mock Data ---
        const salesData = [
            { name: '1月', revenue: 4000, profit: 2400, orders: 240 },
            { name: '2月', revenue: 3000, profit: 1398, orders: 210 },
            { name: '3月', revenue: 2000, profit: 9800, orders: 290 },
            { name: '4月', revenue: 2780, profit: 3908, orders: 300 },
            { name: '5月', revenue: 1890, profit: 4800, orders: 180 },
            { name: '6月', revenue: 2390, profit: 3800, orders: 250 },
            { name: '7月', revenue: 3490, profit: 4300, orders: 310 },
        ];

        const categoryData = [
            { name: '電子產品', value: 400 },
            { name: '服飾', value: 300 },
            { name: '家居', value: 300 },
            { name: '書籍', value: 200 },
        ];

        const COLORS = ['#6366f1', '#8b5cf6', '#ec4899', '#f43f5e'];

        const recentTransactions = [
            { id: 1, user: '張小明', amount: '+$1,250.00', status: 'Completed', date: '2023-10-24', img: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Felix' },
            { id: 2, user: '李美華', amount: '+$650.00', status: 'Processing', date: '2023-10-24', img: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka' },
            { id: 3, user: '王大同', amount: '-$120.50', status: 'Failed', date: '2023-10-23', img: 'https://api.dicebear.com/7.x/avataaars/svg?seed=John' },
            { id: 4, user: '陳雅琪', amount: '+$2,300.00', status: 'Completed', date: '2023-10-23', img: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Sarah' },
            { id: 5, user: '林志豪', amount: '+$850.00', status: 'Completed', date: '2023-10-22', img: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Mike' },
        ];

        // --- Components ---

        const SidebarItem = ({ icon: Icon, text, active, onClick }) => (
            <li 
                onClick={onClick}
                className={`
                    flex items-center p-3 rounded-lg cursor-pointer transition-colors
                    ${active ? 'bg-indigo-50 text-indigo-600' : 'text-gray-600 hover:bg-gray-50'}
                `}
            >
                <Icon size={20} className="mr-3" />
                <span className="font-medium">{text}</span>
            </li>
        );

        const StatCard = ({ title, value, change, isPositive, icon: Icon, colorClass }) => (
            <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100 transition-all hover:shadow-md">
                <div className="flex justify-between items-start">
                    <div>
                        <p className="text-sm font-medium text-gray-500 mb-1">{title}</p>
                        <h3 className="text-2xl font-bold text-gray-800">{value}</h3>
                    </div>
                    <div className={`p-2 rounded-lg ${colorClass} bg-opacity-10`}>
                        <Icon size={20} className={colorClass.replace('bg-', 'text-')} />
                    </div>
                </div>
                <div className="mt-4 flex items-center text-sm">
                    <span className={`flex items-center font-medium ${isPositive ? 'text-green-500' : 'text-red-500'}`}>
                        {isPositive ? <ArrowUpRight size={16} className="mr-1"/> : <ArrowDownRight size={16} className="mr-1"/>}
                        {change}
                    </span>
                    <span className="text-gray-400 ml-2">vs 上個月</span>
                </div>
            </div>
        );

        const App = () => {
            const [sidebarOpen, setSidebarOpen] = useState(true);
            const [activeTab, setActiveTab] = useState('dashboard');
            const [isMobile, setIsMobile] = useState(false);

            // Responsive handler
            useEffect(() => {
                const handleResize = () => {
                    if (window.innerWidth < 1024) {
                        setSidebarOpen(false);
                        setIsMobile(true);
                    } else {
                        setSidebarOpen(true);
                        setIsMobile(false);
                    }
                };
                
                handleResize();
                window.addEventListener('resize', handleResize);
                return () => window.removeEventListener('resize', handleResize);
            }, []);

            return (
                <div className="flex h-screen overflow-hidden bg-gray-50">
                    
                    {/* Mobile Sidebar Overlay */}
                    {isMobile && sidebarOpen && (
                        <div 
                            className="fixed inset-0 bg-black bg-opacity-50 z-20"
                            onClick={() => setSidebarOpen(false)}
                        />
                    )}

                    {/* Sidebar */}
                    <aside className={`
                        fixed inset-y-0 left-0 z-30 w-64 bg-white border-r border-gray-200 transform transition-transform duration-300 ease-in-out
                        ${sidebarOpen ? 'translate-x-0' : '-translate-x-full'}
                        lg:relative lg:translate-x-0
                        ${!sidebarOpen && !isMobile ? 'lg:w-20' : 'lg:w-64'}
                    `}>
                        <div className="h-full flex flex-col">
                            {/* Logo */}
                            <div className="flex items-center justify-center h-16 border-b border-gray-100">
                                <Activity className="text-indigo-600 mr-2" size={28} />
                                {(sidebarOpen || isMobile) && <span className="text-xl font-bold text-gray-800">AdminPanel</span>}
                            </div>

                            {/* Nav Items */}
                            <nav className="flex-1 overflow-y-auto py-4 px-3 space-y-1">
                                <SidebarItem 
                                    icon={LayoutDashboard} 
                                    text={sidebarOpen || isMobile ? "儀表板" : ""} 
                                    active={activeTab === 'dashboard'} 
                                    onClick={() => setActiveTab('dashboard')}
                                />
                                <SidebarItem 
                                    icon={Users} 
                                    text={sidebarOpen || isMobile ? "用戶管理" : ""} 
                                    active={activeTab === 'users'} 
                                    onClick={() => setActiveTab('users')}
                                />
                                <SidebarItem 
                                    icon={ShoppingCart} 
                                    text={sidebarOpen || isMobile ? "訂單列表" : ""} 
                                    active={activeTab === 'orders'} 
                                    onClick={() => setActiveTab('orders')}
                                />
                                <SidebarItem 
                                    icon={Package} 
                                    text={sidebarOpen || isMobile ? "產品庫存" : ""} 
                                    active={activeTab === 'products'} 
                                    onClick={() => setActiveTab('products')}
                                />
                                <SidebarItem 
                                    icon={CreditCard} 
                                    text={sidebarOpen || isMobile ? "財務報表" : ""} 
                                    active={activeTab === 'finance'} 
                                    onClick={() => setActiveTab('finance')}
                                />
                            </nav>

                            {/* User Profile Snippet */}
                            <div className="p-4 border-t border-gray-100">
                                <div className="flex items-center">
                                    <img 
                                        src="https://api.dicebear.com/7.x/avataaars/svg?seed=Admin" 
                                        alt="User" 
                                        className="w-10 h-10 rounded-full bg-gray-200"
                                    />
                                    {(sidebarOpen || isMobile) && (
                                        <div className="ml-3">
                                            <p className="text-sm font-medium text-gray-800">管理員</p>
                                            <p className="text-xs text-gray-500">admin@example.com</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </aside>

                    {/* Main Content */}
                    <div className="flex-1 flex flex-col overflow-hidden">
                        
                        {/* Header */}
                        <header className="bg-white h-16 border-b border-gray-200 flex items-center justify-between px-6 z-10">
                            <div className="flex items-center">
                                <button 
                                    onClick={() => setSidebarOpen(!sidebarOpen)}
                                    className="p-2 rounded-md text-gray-600 hover:bg-gray-100 focus:outline-none lg:hidden"
                                >
                                    <Menu size={20} />
                                </button>
                                
                                {/* Search Bar */}
                                <div className="hidden md:flex items-center ml-4 bg-gray-100 rounded-lg px-3 py-2 w-64">
                                    <Search size={18} className="text-gray-400" />
                                    <input 
                                        type="text" 
                                        placeholder="搜尋..." 
                                        className="bg-transparent border-none outline-none text-sm ml-2 w-full text-gray-600 placeholder-gray-400"
                                    />
                                </div>
                            </div>

                            <div className="flex items-center space-x-4">
                                <button className="p-2 rounded-full text-gray-500 hover:bg-gray-100 relative">
                                    <Bell size={20} />
                                    <span className="absolute top-1 right-1 h-2.5 w-2.5 bg-red-500 rounded-full border-2 border-white"></span>
                                </button>
                            </div>
                        </header>

                        {/* Content Scrollable Area */}
                        <main className="flex-1 overflow-x-hidden overflow-y-auto bg-gray-50 p-6">
                            
                            {/* Page Header */}
                            <div className="flex justify-between items-end mb-6">
                                <div>
                                    <h1 className="text-2xl font-bold text-gray-800">儀表板總覽</h1>
                                    <p className="text-gray-500 mt-1">歡迎回來，這裡是今日的數據概覽。</p>
                                </div>
                                <div className="hidden sm:flex space-x-2">
                                    <button className="flex items-center px-4 py-2 bg-white border border-gray-200 rounded-lg text-sm text-gray-600 hover:bg-gray-50">
                                        <Calendar size={16} className="mr-2" />
                                        本月
                                    </button>
                                    <button className="flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm hover:bg-indigo-700 shadow-sm">
                                        匯出報表
                                    </button>
                                </div>
                            </div>

                            {/* Stats Grid */}
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                                <StatCard 
                                    title="總營收" 
                                    value="$45,231.89" 
                                    change="+20.1%" 
                                    isPositive={true} 
                                    icon={DollarSign} 
                                    colorClass="text-indigo-600 bg-indigo-600"
                                />
                                <StatCard 
                                    title="活躍用戶" 
                                    value="2,350" 
                                    change="+15.2%" 
                                    isPositive={true} 
                                    icon={Users} 
                                    colorClass="text-purple-600 bg-purple-600"
                                />
                                <StatCard 
                                    title="新訂單" 
                                    value="1,203" 
                                    change="-4.5%" 
                                    isPositive={false} 
                                    icon={ShoppingCart} 
                                    colorClass="text-pink-600 bg-pink-600"
                                />
                                <StatCard 
                                    title="轉換率" 
                                    value="3.45%" 
                                    change="+1.2%" 
                                    isPositive={true} 
                                    icon={TrendingUp} 
                                    colorClass="text-orange-600 bg-orange-600"
                                />
                            </div>

                            {/* Charts Section */}
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                                {/* Main Chart */}
                                <div className="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                    <h3 className="text-lg font-bold text-gray-800 mb-4">營收趨勢</h3>
                                    <div className="h-80 w-full">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <AreaChart data={salesData} margin={{ top: 10, right: 10, left: 0, bottom: 0 }}>
                                                <defs>
                                                    <linearGradient id="colorRevenue" x1="0" y1="0" x2="0" y2="1">
                                                        <stop offset="5%" stopColor="#6366f1" stopOpacity={0.3}/>
                                                        <stop offset="95%" stopColor="#6366f1" stopOpacity={0}/>
                                                    </linearGradient>
                                                </defs>
                                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#e5e7eb" />
                                                <XAxis dataKey="name" axisLine={false} tickLine={false} tick={{fill: '#6b7280'}} dy={10} />
                                                <YAxis axisLine={false} tickLine={false} tick={{fill: '#6b7280'}} />
                                                <Tooltip 
                                                    contentStyle={{ backgroundColor: '#fff', borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)' }}
                                                    cursor={{ stroke: '#6366f1', strokeWidth: 1 }}
                                                />
                                                <Area type="monotone" dataKey="revenue" stroke="#6366f1" strokeWidth={3} fillOpacity={1} fill="url(#colorRevenue)" />
                                            </AreaChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>

                                {/* Pie Chart */}
                                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                    <h3 className="text-lg font-bold text-gray-800 mb-4">銷售類別佔比</h3>
                                    <div className="h-60 w-full relative">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <PieChart>
                                                <Pie
                                                    data={categoryData}
                                                    cx="50%"
                                                    cy="50%"
                                                    innerRadius={60}
                                                    outerRadius={80}
                                                    fill="#8884d8"
                                                    paddingAngle={5}
                                                    dataKey="value"
                                                >
                                                    {categoryData.map((entry, index) => (
                                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                                    ))}
                                                </Pie>
                                                <Tooltip />
                                            </PieChart>
                                        </ResponsiveContainer>
                                        <div className="absolute inset-0 flex items-center justify-center flex-col pointer-events-none">
                                            <span className="text-2xl font-bold text-gray-800">1.2k</span>
                                            <span className="text-xs text-gray-500">總銷量</span>
                                        </div>
                                    </div>
                                    <div className="mt-4 space-y-2">
                                        {categoryData.map((item, index) => (
                                            <div key={item.name} className="flex justify-between items-center text-sm">
                                                <div className="flex items-center">
                                                    <div className="w-3 h-3 rounded-full mr-2" style={{ backgroundColor: COLORS[index % COLORS.length] }}></div>
                                                    <span className="text-gray-600">{item.name}</span>
                                                </div>
                                                <span className="font-medium text-gray-800">{item.value}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            {/* Recent Transactions & Top Products */}
                            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                {/* Transactions Table */}
                                <div className="lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                                    <div className="p-6 border-b border-gray-100 flex justify-between items-center">
                                        <h3 className="text-lg font-bold text-gray-800">最近交易</h3>
                                        <button className="text-indigo-600 text-sm font-medium hover:text-indigo-800">查看全部</button>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-left border-collapse">
                                            <thead>
                                                <tr className="bg-gray-50 text-gray-500 text-xs uppercase tracking-wider">
                                                    <th className="px-6 py-4 font-medium">用戶</th>
                                                    <th className="px-6 py-4 font-medium">日期</th>
                                                    <th className="px-6 py-4 font-medium">金額</th>
                                                    <th className="px-6 py-4 font-medium">狀態</th>
                                                    <th className="px-6 py-4 font-medium text-right">操作</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-gray-100">
                                                {recentTransactions.map((tx) => (
                                                    <tr key={tx.id} className="hover:bg-gray-50 transition-colors">
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <div className="flex items-center">
                                                                <img src={tx.img} alt="" className="w-8 h-8 rounded-full bg-gray-200" />
                                                                <span className="ml-3 font-medium text-gray-800 text-sm">{tx.user}</span>
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4 text-sm text-gray-500">
                                                            {tx.date}
                                                        </td>
                                                        <td className={`px-6 py-4 text-sm font-medium ${tx.amount.startsWith('+') ? 'text-green-600' : 'text-red-600'}`}>
                                                            {tx.amount}
                                                        </td>
                                                        <td className="px-6 py-4">
                                                            <span className={`
                                                                px-3 py-1 rounded-full text-xs font-medium
                                                                ${tx.status === 'Completed' ? 'bg-green-100 text-green-700' : 
                                                                  tx.status === 'Processing' ? 'bg-yellow-100 text-yellow-700' : 
                                                                  'bg-red-100 text-red-700'}
                                                            `}>
                                                                {tx.status}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4 text-right">
                                                            <button className="text-gray-400 hover:text-gray-600">
                                                                <MoreHorizontal size={18} />
                                                            </button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                {/* Mini Bar Chart */}
                                <div className="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                                    <h3 className="text-lg font-bold text-gray-800 mb-4">每週訂單</h3>
                                    <div className="h-60">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <BarChart data={salesData}>
                                                <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#e5e7eb" />
                                                <XAxis dataKey="name" tick={{fill: '#9ca3af', fontSize: 12}} axisLine={false} tickLine={false} />
                                                <Tooltip 
                                                    cursor={{fill: '#f3f4f6'}}
                                                    contentStyle={{ backgroundColor: '#fff', borderRadius: '8px', border: 'none' }}
                                                />
                                                <Bar dataKey="orders" fill="#6366f1" radius={[4, 4, 0, 0]} />
                                            </BarChart>
                                        </ResponsiveContainer>
                                    </div>
                                    <div className="mt-4 text-center">
                                        <p className="text-gray-500 text-sm">本週訂單量比上週成長了 <span className="text-green-500 font-bold">12%</span></p>
                                        <button className="mt-3 w-full py-2 bg-gray-50 text-indigo-600 text-sm font-medium rounded-lg hover:bg-gray-100 transition-colors">
                                            查看詳細報告
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </main>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
