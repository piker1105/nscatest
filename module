<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡çµ„åŒ–è¨“ç·´ç³»çµ± | V5 é€±æœŸåŒ–æ——è‰¦ç‰ˆ</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #0f172a;       /* æ·±è— */
            --primary-light: #1e293b; 
            --accent: #3b82f6;        /* äº®è— */
            --bg: #f8fafc;            /* æ·ºç°èƒŒæ™¯ */
            --white: #ffffff;
            --text-main: #334155;
            --text-light: #64748b;
            --border: #e2e8f0;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- Sidebar --- */
        aside {
            width: 260px;
            background: var(--primary);
            color: white;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            transition: 0.3s;
        }
        .brand {
            padding: 25px 20px;
            font-size: 1.3em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .nav-menu { padding: 20px 15px; flex: 1; }
        .nav-item {
            display: flex; align-items: center; gap: 15px;
            padding: 12px 15px; margin-bottom: 5px;
            color: #94a3b8; text-decoration: none;
            border-radius: 10px; cursor: pointer; transition: 0.2s;
        }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: white; }
        .nav-item.active { background: var(--accent); color: white; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); }
        
        /* Reminder Widget in Sidebar */
        .sidebar-widget {
            margin: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            font-size: 0.85em;
        }
        .widget-title { font-weight: bold; color: #cbd5e1; margin-bottom: 10px; display: flex; justify-content: space-between; }

        /* --- Main Content --- */
        main { flex: 1; overflow-y: auto; position: relative; display: flex; flex-direction: column; }
        
        .top-bar {
            background: var(--white); padding: 15px 30px;
            border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 50;
        }

        .content-wrapper { padding: 30px; max-width: 1400px; margin: 0 auto; width: 100%; box-sizing: border-box; }
        .page-view { display: none; animation: fadeIn 0.3s ease; }
        .page-view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Components --- */
        .btn { padding: 8px 16px; border-radius: 8px; border: none; cursor: pointer; font-weight: 600; display: inline-flex; align-items: center; gap: 5px; font-size: 0.9em; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-accent { background: var(--accent); color: white; }
        .btn-outline { background: white; border: 1px solid #cbd5e1; color: var(--text-main); }
        .btn:hover { opacity: 0.9; transform: translateY(-1px); }

        /* Page 1: Dashboard Timeline */
        .timeline-item {
            display: flex; gap: 20px; padding: 20px;
            background: white; border-radius: 12px;
            margin-bottom: 15px; border-left: 5px solid var(--accent);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); align-items: center;
        }
        .time-box { font-weight: bold; font-size: 1.2em; color: var(--primary); min-width: 80px; }

        /* Page 2: Student List */
        .student-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .student-card {
            background: white; border-radius: 12px; padding: 20px;
            border: 1px solid var(--border); cursor: pointer;
            transition: 0.2s; position: relative; overflow: hidden;
        }
        .student-card:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.05); border-color: var(--accent); }
        .card-header { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .avatar { width: 50px; height: 50px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--text-light); }
        .status-tag { position: absolute; top: 20px; right: 20px; font-size: 0.8em; padding: 4px 10px; border-radius: 20px; font-weight: bold; }
        .status-active { background: #dcfce7; color: #166534; }
        .status-expiring { background: #fee2e2; color: #991b1b; }

        /* Page 3: Student Detail & Calendar */
        .profile-header { background: white; border-radius: 12px; padding: 25px; margin-bottom: 20px; border: 1px solid var(--border); }
        .metrics-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border); }
        .metric-box { text-align: center; }
        .metric-val { font-size: 1.4em; font-weight: bold; color: var(--primary); }
        .metric-label { font-size: 0.85em; color: var(--text-light); }

        /* Calendar System */
        .periodization-bar {
            background: var(--primary-light); color: white;
            padding: 15px 20px; border-radius: 12px 12px 0 0;
            display: flex; justify-content: space-between; align-items: center;
        }
        .calendar-container { background: white; padding: 20px; border-radius: 0 0 12px 12px; border: 1px solid var(--border); }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; }
        .cal-header { text-align: center; font-weight: bold; color: var(--text-light); padding: 10px 0; }
        .cal-day {
            min-height: 100px; border: 1px solid #f1f5f9; border-radius: 8px;
            padding: 10px; cursor: pointer; transition: 0.2s; position: relative;
        }
        .cal-day:hover { background: #f8fafc; border-color: var(--accent); }
        .cal-date { font-weight: bold; color: var(--text-light); margin-bottom: 5px; font-size: 0.9em; }
        .workout-dot {
            display: block; background: #e0f2fe; color: #0284c7;
            padding: 4px 8px; border-radius: 4px; font-size: 0.8em;
            margin-top: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        
        /* Editor (Slide over) */
        .editor-panel {
            position: fixed; top: 0; right: -600px; width: 600px; height: 100%;
            background: white; box-shadow: -10px 0 30px rgba(0,0,0,0.1);
            z-index: 100; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column;
        }
        .editor-panel.open { right: 0; }
        .editor-content { padding: 30px; flex: 1; overflow-y: auto; }
        
        /* Module Styling in Editor */
        .module-box { background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid var(--border); }
        .module-box.main-train { border-left: 4px solid var(--danger); background: #fff5f5; }

    </style>
</head>
<body>

    <aside>
        <div class="brand">
            <span class="material-icons">fitness_center</span>
            æ¨¡çµ„åŒ–è¨“ç·´
        </div>
        
        <div class="sidebar-widget">
            <div class="widget-title">
                <span>ğŸ“… ä»Šæ—¥æé†’</span>
                <span style="color:var(--accent)">11/21</span>
            </div>
            <div style="margin-bottom:8px; color:#cbd5e1;">
                <span class="material-icons" style="font-size:14px; vertical-align:text-top;">schedule</span> 3 å ‚èª²ç¨‹
            </div>
            <div style="margin-bottom:8px; color:#cbd5e1;">
                <span class="material-icons" style="font-size:14px; vertical-align:text-top;">place</span> å°åŒ—å¤§å®‰é¤¨
            </div>
        </div>

        <nav class="nav-menu">
            <div class="nav-item active" onclick="navTo('dashboard', this)">
                <span class="material-icons">dashboard</span> å„€è¡¨æ¿
            </div>
            <div class="nav-item" onclick="navTo('students', this)">
                <span class="material-icons">people</span> å­¸å“¡ç®¡ç†
            </div>
            <div class="nav-item" onclick="navTo('library', this)">
                <span class="material-icons">inventory_2</span> å‹•ä½œè³‡æ–™åº«
            </div>
            <div class="nav-item" onclick="alert('åŠŸèƒ½é–‹ç™¼ä¸­')">
                <span class="material-icons">settings</span> ç³»çµ±è¨­å®š
            </div>
        </nav>
    </aside>

    <main>
        
        <div id="page-dashboard" class="page-view active">
            <div class="top-bar">
                <h2>ğŸ‘‹ æ—©å®‰ï¼ŒHarrison æ•™ç·´</h2>
                <button class="btn btn-primary">+ å¿«é€Ÿæ–°å¢</button>
            </div>
            <div class="content-wrapper">
                <h3 style="margin-bottom:20px;">ğŸ“… ä»Šæ—¥è¡Œç¨‹ (Today's Schedule)</h3>
                
                <div class="timeline-item">
                    <div class="time-box">09:00</div>
                    <div style="flex:1">
                        <div style="font-weight:bold; font-size:1.1em;">ç‹å°æ˜ - ä¸‹è‚¢è‚ŒåŠ›</div>
                        <div style="color:var(--text-light); font-size:0.9em;">å°åŒ—å¤§å®‰é¤¨ â€¢ ç¬¬ 3 é€± (è‚Œè‚¥å¤§é€±æœŸ)</div>
                    </div>
                    <button class="btn btn-outline btn-sm">æŸ¥çœ‹</button>
                </div>

                <div class="timeline-item" style="border-left-color:var(--warning)">
                    <div class="time-box">14:00</div>
                    <div style="flex:1">
                        <div style="font-weight:bold; font-size:1.1em;">é™³ç¾éº— - æ ¸å¿ƒæ§åˆ¶</div>
                        <div style="color:var(--text-light); font-size:0.9em;">ç§äººå·¥ä½œå®¤ â€¢ ç¬¬ 1 é€± (é©æ‡‰æœŸ)</div>
                    </div>
                    <button class="btn btn-outline btn-sm">æŸ¥çœ‹</button>
                </div>

                <div class="timeline-item" style="border-left-color:var(--success)">
                    <div class="time-box">19:30</div>
                    <div style="flex:1">
                        <div style="font-weight:bold; font-size:1.1em;">æ—å¤§å±± - å°ˆé …çˆ†ç™¼åŠ›</div>
                        <div style="color:var(--text-light); font-size:0.9em;">å¸‚æ°‘é‹å‹•ä¸­å¿ƒ â€¢ ç¬¬ 6 é€± (åŠ›é‡é€±æœŸ)</div>
                    </div>
                    <button class="btn btn-outline btn-sm">æŸ¥çœ‹</button>
                </div>

            </div>
        </div>

        <div id="page-students" class="page-view">
            <div class="top-bar">
                <h2>ğŸ‘¥ å­¸å“¡ç®¡ç†</h2>
                <button class="btn btn-primary">+ æ–°å¢å­¸å“¡</button>
            </div>
            <div class="content-wrapper">
                <div style="margin-bottom:20px; display:flex; gap:10px;">
                    <input type="text" placeholder="æœå°‹å­¸å“¡å§“å..." style="padding:10px; width:300px; border:1px solid #ccc; border-radius:8px;">
                    <select style="padding:10px; border-radius:8px; border:1px solid #ccc;"><option>æ‰€æœ‰ç‹€æ…‹</option><option>å³å°‡åˆ°æœŸ</option></select>
                </div>

                <div class="student-grid" id="student-list-container">
                    </div>
            </div>
        </div>

        <div id="page-student-detail" class="page-view">
            <div class="top-bar">
                <div style="display:flex; align-items:center; gap:10px;">
                    <button class="btn btn-outline" onclick="navTo('students')"><span class="material-icons">arrow_back</span></button>
                    <h2 id="detail-name" style="margin:0">å­¸å“¡è©³æƒ…</h2>
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="btn btn-outline" onclick="alert('ç·¨è¼¯å€‹è³‡')">âœï¸ ä¿®æ”¹å€‹äººè³‡æ–™</button>
                    <button class="btn btn-primary">çºŒç´„æœƒç±</button>
                </div>
            </div>

            <div class="content-wrapper">
                <div class="profile-header">
                    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                        <div>
                            <h1 style="margin:0; font-size:1.8em; color:var(--primary);" id="p-name">ç‹å°æ˜</h1>
                            <p style="color:var(--text-light); margin:5px 0;">ç›®æ¨™ï¼š<span id="p-goal">å¢è‚Œ / è‚Œè‚¥å¤§</span></p>
                            <span class="status-active" style="background:#e0f2fe; color:#0369a1; padding:2px 8px; border-radius:4px; font-size:0.8em;">æœƒç±å‰©é¤˜ï¼š45 å¤©</span>
                        </div>
                        <div style="text-align:right; font-size:0.9em; color:var(--text-light);">
                            ä¸Šæ¬¡æ¸¬é‡ï¼š2025/10/20<br>
                            å‚·ç—…å²ï¼šå·¦è‚©å¤¾æ“  (å·²æ¢å¾© 90%)
                        </div>
                    </div>
                    
                    <div class="metrics-grid">
                        <div class="metric-box">
                            <div class="metric-val" id="m-weight">72.5</div>
                            <div class="metric-label">é«”é‡ (kg)</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-val" id="m-pbf">18.5%</div>
                            <div class="metric-label">é«”è„‚ç‡</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-val" id="m-smm">34.2</div>
                            <div class="metric-label">éª¨éª¼è‚Œé‡ (kg)</div>
                        </div>
                        <div class="metric-box">
                            <div class="metric-val">23.4</div>
                            <div class="metric-label">BMI</div>
                        </div>
                    </div>
                </div>

                <h3 style="margin-bottom:15px;">ğŸ“… èª²è¡¨ç®¡ç† (Training Log)</h3>
                
                <div class="periodization-bar">
                    <div>
                        <span style="opacity:0.7">2025 å¹´åº¦è¨ˆç•« > Q4 > </span>
                        <span style="font-weight:bold; font-size:1.1em;">è‚Œè‚¥å¤§é€±æœŸ (Hypertrophy Block)</span>
                    </div>
                    <div style="display:flex; gap:10px; align-items:center;">
                        <button class="btn btn-outline btn-sm" style="background:rgba(255,255,255,0.2); color:white; border:none;">&lt;</button>
                        <span>11æœˆ November</span>
                        <button class="btn btn-outline btn-sm" style="background:rgba(255,255,255,0.2); color:white; border:none;">&gt;</button>
                    </div>
                </div>

                <div class="calendar-container">
                    <div class="calendar-grid">
                        <div class="cal-header">MON</div><div class="cal-header">TUE</div><div class="cal-header">WED</div>
                        <div class="cal-header">THU</div><div class="cal-header">FRI</div><div class="cal-header">SAT</div><div class="cal-header">SUN</div>
                        
                        <div id="calendar-days" style="display:contents;"></div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <div id="workout-editor" class="editor-panel">
        <div style="padding:20px; background:var(--primary); color:white; display:flex; justify-content:space-between; align-items:center;">
            <h3 style="margin:0" id="editor-date">11/21 è¨“ç·´èª²è¡¨</h3>
            <button class="btn btn-outline btn-sm" onclick="closeEditor()">é—œé–‰ X</button>
        </div>
        <div class="editor-content">
            <div style="margin-bottom:20px;">
                <label style="font-size:0.9em; color:gray;">è¨“ç·´ä¸»é¡Œ</label>
                <input type="text" value="ä¸‹è‚¢æ¨ | è¹²èˆ‰é‡é»" style="width:100%; padding:10px; margin-top:5px; border:1px solid #ccc; border-radius:6px;">
            </div>

            <div class="module-box">
                <div style="font-weight:bold; color:var(--text-main); margin-bottom:10px;">ğŸ”¥ æš–èº«æ¨¡çµ„</div>
                <div style="font-size:0.9em;">â€¢ 90/90 å‘¼å¸ x 2 min</div>
                <div style="font-size:0.9em;">â€¢ é’è›™è¶´ x 10 reps</div>
            </div>

            <div class="module-box main-train">
                <div style="font-weight:bold; color:#991b1b; margin-bottom:10px;">ğŸ‹ï¸ ä¸»è¦è¨“ç·´æ¨¡çµ„</div>
                <div style="background:white; padding:10px; border:1px solid #eee; margin-bottom:5px; border-radius:4px;">
                    <div style="font-weight:bold;">èƒŒæ§“æ·±è¹² (Back Squat)</div>
                    <div style="color:gray; font-size:0.9em;">4 çµ„ x 6 ä¸‹ @ RPE 8</div>
                </div>
                <div style="background:white; padding:10px; border:1px solid #eee; border-radius:4px;">
                    <div style="font-weight:bold;">ç¾…é¦¬å°¼äºç¡¬èˆ‰ (RDL)</div>
                    <div style="color:gray; font-size:0.9em;">3 çµ„ x 10 ä¸‹ @ RPE 7</div>
                </div>
            </div>

            <button class="btn btn-primary" style="width:100%; margin-top:20px;">å„²å­˜è®Šæ›´</button>
            <button class="btn btn-outline" style="width:100%; margin-top:10px; color:var(--danger); border-color:var(--danger);">åˆªé™¤æ­¤è¨“ç·´</button>
        </div>
    </div>

<script>
    // --- è³‡æ–™ Mock ---
    const students = [
        { 
            id: 1, name: 'ç‹å°æ˜', goal: 'å¢è‚Œ / è‚Œè‚¥å¤§', expiry: '2025-12-31', 
            metrics: { weight: 72.5, pbf: '18.5%', smm: 34.2 },
            status: 'active'
        },
        { 
            id: 2, name: 'é™³ç¾éº—', goal: 'æ¸›è„‚ / é«”æ…‹é›•å¡‘', expiry: '2025-11-25', 
            metrics: { weight: 54.0, pbf: '24.0%', smm: 21.5 },
            status: 'expiring'
        },
        { 
            id: 3, name: 'æ—å¤§å±±', goal: 'åŠ›é‡ / å¥åŠ›ä¸‰é …', expiry: '2026-03-10', 
            metrics: { weight: 88.0, pbf: '15.0%', smm: 42.0 },
            status: 'active'
        }
    ];

    // æ¨¡æ“¬è¨“ç·´ç´€éŒ„ (key: æ—¥æœŸ)
    const workoutLogs = {
        '2025-11-03': 'ä¸Šè‚¢æ¨',
        '2025-11-05': 'ä¸‹è‚¢è¹²',
        '2025-11-07': 'å…¨èº«ä»£è¬',
        '2025-11-20': 'èƒŒéƒ¨å°ˆé …',
    };

    // --- å°è¦½é‚è¼¯ ---
    function navTo(pageId, el) {
        // Sidebar Active State
        if(el) {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
        }
        // Page Switch
        document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
        document.getElementById(`page-${pageId}`).classList.add('active');

        if(pageId === 'students') renderStudentList();
    }

    // --- æ¸²æŸ“å­¸å“¡åˆ—è¡¨ ---
    function renderStudentList() {
        const container = document.getElementById('student-list-container');
        container.innerHTML = '';
        
        students.forEach(stu => {
            const isExpiring = stu.status === 'expiring';
            const statusBadge = isExpiring 
                ? `<span class="status-tag status-expiring">âš ï¸ æœƒç±å³å°‡åˆ°æœŸ</span>`
                : `<span class="status-tag status-active">â— æ´»èº</span>`;
            
            const expiryColor = isExpiring ? 'color:#ef4444; font-weight:bold;' : 'color:#64748b;';

            container.innerHTML += `
                <div class="student-card" onclick="openStudentDetail(${stu.id})">
                    ${statusBadge}
                    <div class="card-header">
                        <div class="avatar">${stu.name[0]}</div>
                        <div>
                            <div style="font-weight:bold; font-size:1.2em;">${stu.name}</div>
                            <div style="font-size:0.9em; color:#64748b;">${stu.goal}</div>
                        </div>
                    </div>
                    <div style="font-size:0.85em; border-top:1px solid #f1f5f9; padding-top:10px;">
                        <span style="${expiryColor}">åˆ°æœŸæ—¥ï¼š${stu.expiry}</span>
                    </div>
                </div>
            `;
        });
    }

    // --- æ‰“é–‹å­¸å“¡è©³æƒ… & æ¸²æŸ“æ—¥æ›† ---
    function openStudentDetail(id) {
        const stu = students.find(s => s.id === id);
        if(!stu) return;

        // å¡«å…¥å€‹è³‡
        document.getElementById('p-name').innerText = stu.name;
        document.getElementById('p-goal').innerText = stu.goal;
        document.getElementById('m-weight').innerText = stu.metrics.weight;
        document.getElementById('m-pbf').innerText = stu.metrics.pbf;
        document.getElementById('m-smm').innerText = stu.metrics.smm;
        document.getElementById('detail-name').innerText = stu.name + " çš„æª”æ¡ˆ";

        // ç”Ÿæˆ 11æœˆæ—¥æ›† (ç°¡å–®æ¨¡æ“¬ 30 å¤©)
        const calContainer = document.getElementById('calendar-days');
        calContainer.innerHTML = '';

        // å‡è¨­ 11/1 æ˜¯æ˜ŸæœŸå…­ï¼Œå‰é¢è£œ 5 å€‹ç©ºä½
        for(let i=0; i<5; i++) {
            calContainer.innerHTML += `<div style="background:transparent;"></div>`;
        }

        for(let day=1; day<=30; day++) {
            const dateStr = `2025-11-${day.toString().padStart(2, '0')}`;
            const hasWorkout = workoutLogs[dateStr];
            const workoutHtml = hasWorkout 
                ? `<span class="workout-dot">${hasWorkout}</span>` 
                : '';

            calContainer.innerHTML += `
                <div class="cal-day" onclick="openWorkoutEditor('${dateStr}')">
                    <div class="cal-date">${day}</div>
                    ${workoutHtml}
                    ${day === 21 ? '<div style="width:6px; height:6px; background:red; border-radius:50%; position:absolute; top:10px; right:10px;"></div>' : ''} 
                </div>
            `;
        } // (Day 21 åŠ ç´…é»æ¨¡æ“¬"ä»Šå¤©")

        // åˆ‡æ›é é¢
        document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
        document.getElementById('page-student-detail').classList.add('active');
    }

    // --- å´æ»‘ç·¨è¼¯å™¨ ---
    function openWorkoutEditor(date) {
        document.getElementById('editor-date').innerText = `${date} è¨“ç·´èª²è¡¨`;
        document.getElementById('workout-editor').classList.add('open');
    }
    function closeEditor() {
        document.getElementById('workout-editor').classList.remove('open');
    }

    // åˆå§‹ç•«é¢
    renderStudentList();

</script>
</body>
</html>
